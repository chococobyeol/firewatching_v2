<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THREE.Fire - 파라미터 조정 가능</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        
        #controls {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 8px;
            z-index: 100;
            font-size: 12px;
            max-height: 90vh;
            overflow-y: auto;
            min-width: 250px;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-group h3 {
            margin: 0 0 8px 0;
            color: #ff6600;
            font-size: 14px;
        }
        
        .control-item {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .control-item label {
            flex: 1;
            margin-right: 10px;
        }
        
        .control-item input[type="range"] {
            flex: 2;
            margin-right: 8px;
        }
        
        .control-item span {
            min-width: 40px;
            text-align: right;
            font-size: 11px;
        }
        
        input[type="range"] {
            width: 100px;
        }
        
        canvas {
            display: block;
        }
        
        #toggle-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 102, 0, 0.8);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            z-index: 101;
        }
    </style>
</head>
<body>
    <button id="toggle-controls">컨트롤 숨기기/보이기</button>
    
    <div id="controls">
        <h2 style="margin-top: 0; color: #ff6600;">🔥 Fire Controls</h2>
        
        <div class="control-group">
            <h3>기본 설정</h3>
            <div class="control-item">
                <label>크기 (Scale):</label>
                <input type="range" id="scale" min="0.5" max="5" step="0.1" value="2">
                <span id="scale-value">2.0</span>
            </div>
            <div class="control-item">
                <label>회전 속도:</label>
                <input type="range" id="rotation-speed" min="0" max="2" step="0.1" value="0.5">
                <span id="rotation-speed-value">0.5</span>
            </div>
        </div>
        
        <div class="control-group">
            <h3>불 모양 조정</h3>
            <div class="control-item">
                <label>Magnitude:</label>
                <input type="range" id="magnitude" min="0.1" max="3" step="0.1" value="1.3">
                <span id="magnitude-value">1.3</span>
            </div>
            <div class="control-item">
                <label>Lacunarity:</label>
                <input type="range" id="lacunarity" min="1" max="4" step="0.1" value="2.0">
                <span id="lacunarity-value">2.0</span>
            </div>
            <div class="control-item">
                <label>Gain:</label>
                <input type="range" id="gain" min="0.1" max="1" step="0.05" value="0.5">
                <span id="gain-value">0.5</span>
            </div>
            <div class="control-item">
                <label>아래쪽 너비:</label>
                <input type="range" id="base-width" min="0.1" max="1" step="0.05" value="0.5">
                <span id="base-width-value">0.5</span>
            </div>
        </div>
        
        <div class="control-group">
            <h3>노이즈 스케일</h3>
            <div class="control-item">
                <label>X 스케일:</label>
                <input type="range" id="noise-scale-x" min="0.1" max="3" step="0.1" value="1">
                <span id="noise-scale-x-value">1.0</span>
            </div>
            <div class="control-item">
                <label>Y 스케일:</label>
                <input type="range" id="noise-scale-y" min="0.1" max="5" step="0.1" value="2">
                <span id="noise-scale-y-value">2.0</span>
            </div>
            <div class="control-item">
                <label>Z 스케일:</label>
                <input type="range" id="noise-scale-z" min="0.1" max="3" step="0.1" value="1">
                <span id="noise-scale-z-value">1.0</span>
            </div>
            <div class="control-item">
                <label>속도 (Speed):</label>
                <input type="range" id="noise-scale-w" min="0.1" max="1" step="0.05" value="0.3">
                <span id="noise-scale-w-value">0.3</span>
            </div>
        </div>
        
        <div class="control-group">
            <h3>색상</h3>
            <div class="control-item">
                <label>빨강:</label>
                <input type="range" id="color-r" min="0" max="255" step="1" value="238">
                <span id="color-r-value">238</span>
            </div>
            <div class="control-item">
                <label>초록:</label>
                <input type="range" id="color-g" min="0" max="255" step="1" value="238">
                <span id="color-g-value">238</span>
            </div>
            <div class="control-item">
                <label>파랑:</label>
                <input type="range" id="color-b" min="0" max="255" step="1" value="238">
                <span id="color-b-value">238</span>
            </div>
        </div>
        
        <div class="control-group">
            <button onclick="resetToDefaults()" style="background: #ff6600; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; width: 100%;">
                기본값으로 리셋
            </button>
        </div>
    </div>

    <!-- Three.js 라이브러리 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r79/three.min.js"></script>
    
    <!-- Fire shader and Fire class -->
    <script src="FireShader.js"></script>
    <script src="Fire.js"></script>

    <script>
        var scene, camera, renderer, fire;
        var clock = new THREE.Clock();
        var rotationSpeed = 0.5;

        function init() {
            // Scene 생성
            scene = new THREE.Scene();

            // Camera 생성
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 0, 5);

            // Renderer 생성
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0x000000);
            document.body.appendChild(renderer.domElement);

            // Fire 텍스처 로드 및 Fire 객체 생성
            var textureLoader = new THREE.TextureLoader();
            textureLoader.load('Fire.png', function(texture) {
                // Fire 객체 생성
                fire = new THREE.Fire(texture);
                fire.scale.set(2, 2, 2);
                scene.add(fire);
                
                console.log('Fire object created successfully!');
                setupControls();
            }, undefined, function(error) {
                console.error('Error loading fire texture:', error);
            });

            // 조명 추가
            var ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);

            // 윈도우 리사이즈 이벤트
            window.addEventListener('resize', onWindowResize, false);
            
            // 컨트롤 토글 버튼
            document.getElementById('toggle-controls').addEventListener('click', function() {
                var controls = document.getElementById('controls');
                controls.style.display = controls.style.display === 'none' ? 'block' : 'none';
            });
        }

        function setupControls() {
            if (!fire) return;

            // 스케일 컨트롤
            setupSlider('scale', function(value) {
                fire.scale.set(value, value, value);
            });

            // 회전 속도 컨트롤
            setupSlider('rotation-speed', function(value) {
                rotationSpeed = value;
            });

            // 불 파라미터 컨트롤
            setupSlider('magnitude', function(value) {
                fire.material.uniforms.magnitude.value = value;
            });

            setupSlider('lacunarity', function(value) {
                fire.material.uniforms.lacunarity.value = value;
            });

            setupSlider('gain', function(value) {
                fire.material.uniforms.gain.value = value;
            });

            setupSlider('base-width', function(value) {
                fire.material.uniforms.baseWidth.value = value;
            });

            // 노이즈 스케일 컨트롤
            setupSlider('noise-scale-x', function(value) {
                fire.material.uniforms.noiseScale.value.x = value;
            });

            setupSlider('noise-scale-y', function(value) {
                fire.material.uniforms.noiseScale.value.y = value;
            });

            setupSlider('noise-scale-z', function(value) {
                fire.material.uniforms.noiseScale.value.z = value;
            });

            setupSlider('noise-scale-w', function(value) {
                fire.material.uniforms.noiseScale.value.w = value;
            });

            // 색상 컨트롤
            function updateColor() {
                var r = document.getElementById('color-r').value / 255;
                var g = document.getElementById('color-g').value / 255;
                var b = document.getElementById('color-b').value / 255;
                fire.material.uniforms.color.value.setRGB(r, g, b);
            }

            setupSlider('color-r', updateColor);
            setupSlider('color-g', updateColor);
            setupSlider('color-b', updateColor);
        }

        function setupSlider(id, callback) {
            var slider = document.getElementById(id);
            var valueSpan = document.getElementById(id + '-value');
            
            slider.addEventListener('input', function() {
                var value = parseFloat(this.value);
                valueSpan.textContent = value.toFixed(2);
                callback(value);
            });
        }

        function resetToDefaults() {
            if (!fire) return;

            // 슬라이더 값들을 기본값으로 리셋
            document.getElementById('scale').value = 2;
            document.getElementById('rotation-speed').value = 0.5;
            document.getElementById('magnitude').value = 1.3;
            document.getElementById('lacunarity').value = 2.0;
            document.getElementById('gain').value = 0.5;
            document.getElementById('base-width').value = 0.5;
            document.getElementById('noise-scale-x').value = 1;
            document.getElementById('noise-scale-y').value = 2;
            document.getElementById('noise-scale-z').value = 1;
            document.getElementById('noise-scale-w').value = 0.3;
            document.getElementById('color-r').value = 238;
            document.getElementById('color-g').value = 238;
            document.getElementById('color-b').value = 238;

            // 값들을 실제로 적용
            fire.scale.set(2, 2, 2);
            rotationSpeed = 0.5;
            fire.material.uniforms.magnitude.value = 1.3;
            fire.material.uniforms.lacunarity.value = 2.0;
            fire.material.uniforms.gain.value = 0.5;
            fire.material.uniforms.baseWidth.value = 0.5;
            fire.material.uniforms.noiseScale.value.set(1, 2, 1, 0.3);
            fire.material.uniforms.color.value.setRGB(238/255, 238/255, 238/255);

            // 표시값 업데이트
            updateAllDisplayValues();
        }

        function updateAllDisplayValues() {
            var sliders = ['scale', 'rotation-speed', 'magnitude', 'lacunarity', 'gain', 'base-width',
                          'noise-scale-x', 'noise-scale-y', 'noise-scale-z', 'noise-scale-w',
                          'color-r', 'color-g', 'color-b'];
            
            sliders.forEach(function(id) {
                var slider = document.getElementById(id);
                var valueSpan = document.getElementById(id + '-value');
                valueSpan.textContent = parseFloat(slider.value).toFixed(2);
            });
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);

            // 카메라 자동 회전
            var time = clock.getElapsedTime();
            camera.position.x = Math.cos(time * rotationSpeed) * 5;
            camera.position.z = Math.sin(time * rotationSpeed) * 5;
            camera.lookAt(scene.position);

            // Fire 애니메이션 업데이트
            if (fire) {
                fire.update(time);
            }

            // 렌더링
            renderer.render(scene, camera);
        }

        // 초기화 및 애니메이션 시작
        init();
        animate();
    </script>
</body>
</html> 